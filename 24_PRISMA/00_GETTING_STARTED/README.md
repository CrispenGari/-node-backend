### Getting started with Prisma

In this section we are going to setup the environment of getting started with PRISMA. First we are going to use [initialiseur](https://github.com/CrispenGari/initialiseur) to initialize the basic node.js application with typescript configurations as follows:

```shell
initialiseur init
```

> Note that you are only allowed to run this command when you have `initialiseur` installed globally otherwise you need to run the following command:

```shell
npx initialiseur init
```

### Installing prisma

To install prisma as a dev dependency, in my case I'm using `yarn` as a package manager we run the following command:

```shell
yarn add -D prisma
```

### Setting up Prisma

We can use the prisma CLI since we have prisma installed. We are going to use the `init` command to initialize a new prisma database. The commands can be found [here](https://www.prisma.io/docs/reference/api-reference/command-reference#run-prisma-init).
To setup prisma we are going to run the following command:

```shell
yarn prisma init
```

You'll notice a new folder in your project named `prisma` as well as a `.env` file in our project's root. The contents of that folder should just be a file named `schema.prisma`, which is the file where we will define how the Prisma Client should get generated and model our data.

So by default the `prisma/schema.prisma` file will look as follows:

```
generator client {
  provider = "prisma-client-js"
}
datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}
```

And the `.env` file will be looking as follows:

```
DATABASE_URL="postgresql://johndoe:randompassword@localhost:5432/mydb?schema=public"
```

> We can see that we are using `postgresql` by default but we want to change to use the `mysql` database. So we are going to change the two files `prisma/schema.prisma` and `.env` to look as follows:

```
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}
```

`.env`

```
DATABASE_URL="mysql://root:root@localhost:3306/prisma_intro"
```

Next we will create a new database called `prisma_intro` using the `MySQL` command line shell, by running the following command:

```sql
CREATE DATABASE IF NOT EXISTS prisma_intro;
```

> Note that from the `DATABASE_URL` you have to change the password and username to your own credentials. The customizable url of the database is `DATABASE_URL="<engine>://<user>:<password>@localhost:<port>/<database_name>"`

### Defining our models.

In this simple demonstration we are going to create a simple model `User`. There are various different kinds of blocks in a `.schema` file that do different things and have tons of different options. In the `schema.prisma` we are going to add the following code to it:

```
...
model User {
  id        Int   @id @default(autoincrement())
  firstName String
  lastName  String
  email     String
}
```

This defines a `User` table for `Prisma` so it will know how to generate a nice, typed client that allows us to interact with the data. Right now our database is empty though, we'll need to push our schema into the database to actually create that table. _(This command should also generate the Prisma Client after pushing the schema)_

### Prisma client

Before we do that we need to install the `prisma/client` by running the following command:

```shell
yarn add @prisma/client
```

Then after that we can now run the following command:

```shell
yarn prisma db push
```

### Prisma Studio

After running the above command we can open prisma studio by running the following command:

```shell
yarn prisma studio
```

You can open the prisma studio at http://localhost:5555. When you open it you will be able to see the `User` model we have just created.

### Prisma Client'

The `Prisma Client` is generated by default into your `node_modules` folder under `@prisma/client`.

```ts
import { PrismaClient } from "@prisma/client";
const prisma = new PrismaClient();
const main = async () => {
  await prisma.$connect();
};
main()
  .then(() => console.log("Connected to prisma.!!!"))
  .catch((error) => console.log(error.message))
  .finally(async () => {
    await prisma.$disconnect();
  });
```

If everything is working we should be able to see the message on the console saying "Connected to prisma.!!!"

### Querying the database

We are going to the `server.ts` and write the following code to query all the users in the database using `prisma`.

```ts
import { PrismaClient } from "@prisma/client";

const prisma = new PrismaClient();

const main = async () => {
  const users = await prisma.user.findMany();
  console.log(users);
};

main()
  .then(() => {})
  .catch((error) => console.log(error.message))
  .finally(async () => {
    await prisma.$disconnect();
  });
```

If everything went well we should see an empty array showing that there are no records of user in the database.

> Note that with `prisma` you don't have to define the types they are generated when we run the `prisma push` command:

```ts
const users: User[] = await prisma.user.findMany();
console.log(users);
```

### Adding a user using `Prisma Studio`

We can run the following command to start the `prisma studio` and add a record in the database.

```shell
yarn prisma studio
```

> Next we are going to create a basic CRUD operations using prisma on our user model.

### Refs

1. [www.prisma.io](https://www.prisma.io/docs/reference/api-reference/command-reference#run-prisma-init)
2. [dev.to](https://dev.to/sabinthedev/starting-a-prisma-typescript-project-4c3g)
